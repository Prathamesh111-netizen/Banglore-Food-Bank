name: Deployment workflow
  
on:
  push: 
    branches: 
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: |
          curl https://get.okteto.com -sSfL | sh
          okteto context use https://cloud.okteto.com --token ${{ secrets.OKTETO_TOKEN }}
          
          cd server
          echo "${{ secrets.SERVER_ENV_FILE }}" > .env
          okteto deploy --build
          
          cd ../client
          echo "${{ secrets.CLIENT_ENV_FILE }}" > .env
          okteto deploy --build
    
          
          
    
  
  
